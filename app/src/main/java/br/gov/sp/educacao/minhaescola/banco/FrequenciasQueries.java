package br.gov.sp.educacao.minhaescola.banco;import android.content.ContentValues;import android.content.Context;import android.database.Cursor;import android.database.sqlite.SQLiteDatabase;import java.util.ArrayList;import br.gov.sp.educacao.minhaescola.model.Frequencia;public class FrequenciasQueries {    private SQLiteDatabase db;    public FrequenciasQueries(Context ctx) {        DBCore auxDB = new DBCore(ctx);        db = auxDB.getWritableDatabase();    }    public void inserirFreq(ArrayList<Frequencia> frequencias) {        ContentValues valores;        for (Frequencia frequencia : frequencias) {            if (!temFrequencia(frequencia)) {                valores = new ContentValues();                valores.put("cd_aluno", frequencia.getCd_aluno());                valores.put("cd_disciplina", frequencia.getCd_disciplina());                valores.put("bimestre", frequencia.getBimestre());                valores.put("nome_disciplina", frequencia.getNome_disciplina());                valores.put("falta", frequencia.getFalta());                valores.put("ausencias_compensada", frequencia.getAusencia_compensada());                valores.put("porcentagem_faltas", frequencia.getPorcentagemFalta());                db.insertWithOnConflict("frequencia", null, valores, SQLiteDatabase.CONFLICT_REPLACE);            }        }    }    private boolean temFrequencia(Frequencia frequencia) {        String[] colunas = new String[]{"cd_frequencia"};        Cursor cursor = db.query("frequencia", colunas, "cd_aluno = ? AND bimestre = ? " +                        "AND cd_disciplina = ? AND nome_disciplina = ?",                new String[]{String.valueOf(frequencia.getCd_aluno()), String.valueOf(frequencia.getBimestre()),                        String.valueOf(frequencia.getCd_disciplina()), String.valueOf(frequencia.getNome_disciplina())},                null, null, null);        if (cursor.moveToFirst()) {            cursor.close();            return true;        } else {            cursor.close();            return false;        }    }    public boolean temFrequenciaBanco(int cd_aluno) {        String[] colunas = new String[]{"cd_frequencia"};        Cursor cursor = db.query("frequencia", colunas, "cd_aluno = ?", new String[]{String.valueOf(cd_aluno)},                null, null, null);        if (cursor.moveToFirst()) {            cursor.close();            return true;        } else {            cursor.close();            return false;        }    }    public int maiorBimestre() {        Cursor cursor = db.rawQuery("select MAX(bimestre) from frequencia", null);        if (cursor != null) {            cursor.moveToFirst();        }        int bimestre = cursor.getInt(0);        cursor.close();        return bimestre;    }    public ArrayList<Frequencia> getFreq(int cd_aluno, int bimestre) {        ArrayList<Frequencia> frequencia = new ArrayList<>();        String[] colunas = new String[]                {"cd_frequencia",                        "cd_aluno",                        "cd_disciplina",                        "bimestre",                        "nome_disciplina",                        "falta",                        "ausencias_compensada",                        "porcentagem_faltas"};        Cursor cursor = db.query("frequencia", colunas, "cd_aluno = ?  AND bimestre = ?", new String[]{String.valueOf(cd_aluno), String.valueOf(bimestre)},                null, null, null);        if (cursor.moveToFirst()) {            Frequencia frequencias;            do {                frequencias = new Frequencia();                frequencias.setCd_frequencia(cursor.getInt(0));                frequencias.setCd_aluno(cursor.getInt(1));                frequencias.setCd_disciplina(cursor.getInt(2));                frequencias.setBimestre(cursor.getInt(3));                frequencias.setNome_disciplina(cursor.getString(4));                frequencias.setFalta(cursor.getInt(5));                frequencias.setAusencias_compensada(cursor.getInt(6));                frequencias.setPorcentagemfalta(cursor.getFloat(7));                frequencia.add(frequencias);            }            while (cursor.moveToNext());        }        cursor.close();        return frequencia;    }}